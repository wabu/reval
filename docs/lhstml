#!/usr/bin/sed -f

1i\
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"\
              "http://www.w3.org/TR/html4/loose.dtd">\
<html>\
  <head>\
    <title>lhstml</title><meta content="text/html; charset=UTF-8"  http-equiv="Content-Type" />\
  </head>\
  <body>\

s,^- \(.*\) -$,<h1>\1</h1>, 
s,^-- \(.*\) --$,<h2>\1</h2>, 
s,^--- \(.*\) ---$,<h3>\1</h3>, 

/^>/{
    s/^>/<pre>\n/
    :code
    N
    s/\n>/\n/
    tcode
    s/\n$/\n<\/pre>\n/
}

$i\
  </body>\
</html>
